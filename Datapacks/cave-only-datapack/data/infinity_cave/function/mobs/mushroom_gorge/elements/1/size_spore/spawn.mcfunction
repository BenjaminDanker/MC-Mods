$summon area_effect_cloud $(pos_x) $(pos_y) $(pos_z) {custom_particle:{type:"warped_spore"},ReapplicationDelay:60,Radius:5f,RadiusPerTick:0.0f,RadiusOnUse:0f,Duration:60,DurationOnUse:0,Age:-10000,WaitTime:-10000,potion_contents:{custom_effects:[{id:"minecraft:nausea",amplifier:0,duration:100,show_particles:1b,show_icon:1b,ambient:1b}]},Passengers:[{id:"minecraft:area_effect_cloud",custom_particle:{type:"minecraft:spore_blossom_air"},ReapplicationDelay:0,Radius:5f,RadiusPerTick:0f,RadiusOnUse:0f,Duration:60,DurationOnUse:0,Age:-10000,WaitTime:-10000}]}

$execute if predicate {condition:"minecraft:random_chance",chance:0.2} run summon area_effect_cloud $(pos_x) $(pos_y) $(pos_z) {custom_particle:{type:"minecraft:falling_spore_blossom"},ReapplicationDelay:0,Radius:5f,RadiusPerTick:0.0f,RadiusOnUse:0f,Duration:60,DurationOnUse:0,Age:-10000,WaitTime:-10000,potion_contents:{custom_effects:[{id:"minecraft:unluck",amplifier:0,duration:20000,show_particles:1b,show_icon:1b,ambient:1b}]}}

$execute if predicate {condition:"minecraft:random_chance",chance:0.01} run summon area_effect_cloud $(pos_x) $(pos_y) $(pos_z) {custom_particle:{type:"minecraft:falling_spore_blossom"},ReapplicationDelay:0,Radius:5f,RadiusPerTick:0.0f,RadiusOnUse:0f,Duration:60,DurationOnUse:0,Age:-10000,WaitTime:-10000,potion_contents:{custom_effects:[{id:"minecraft:unluck",amplifier:0,duration:-1,show_particles:1b,show_icon:1b,ambient:1b}]}}

$execute positioned $(pos_x) $(pos_y) $(pos_z) as @e[type=#infinity_cave:shrink_or_enlarge,distance=..6] run function infinity_cave:mechanics/food/magic_mushroom/$(effect)